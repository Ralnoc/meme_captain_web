<% if @gend_image.work_in_progress? %>
    <p>
      This image is still being processed. Wait a few seconds or reload the page.
    </p>
<% else %>
    <div class="row-fluid">
      <div class="span6">
        <p>
          <%= link_to image_tag(@gend_image_url, size: "#{@gend_image.width}x#{@gend_image.height}"), @gend_image_url %>
        </p>
      </div>

      <div class="span6">

        <blockquote>
          <% @gend_image.captions.position_order.each do |c| %>
              <h1><%= c.text %></h1>
          <% end %>

          <% unless @gend_image.src_image.name.blank? %>
              <small><%= @gend_image.src_image.name %></small>
          <% end %>
        </blockquote>

        <%= link_to("http://www.reddit.com/submit?url=#{u(@gend_image_url)}", class: 'btn') do %>
            <i class="icon-arrow-up"></i> Reddit
        <% end %>

        <%= link_to("http://api.imgur.com/2/upload?url=#{u(@gend_image_url)}", class: 'btn') do %>
            <i class="icon-picture"></i> Imgur
        <% end %>

        <%= link_to("https://twitter.com/intent/tweet?url=#{u(@gend_image_url)}&hashtags=memecaptain", class: 'btn') do %>
            <i class="icon-twitter"></i> Tweet
        <% end %>

        <%= link_to("http://pinterest.com/pin/create/button/?url=#{u(gend_image_page_url(:id => @gend_image.id_hash))}&media=#{u(@gend_image_url)}", class: 'btn') do %>
            <i class="icon-pinterest"></i> Pinterest
        <% end %>

        <%= link_to("http://facebook.com/sharer.php?u=#{u(@gend_image_url)}", class: 'btn') do %>
            <i class="icon-facebook"></i> Facebook
        <% end %>

        <%= link_to("https://plus.google.com/share?url=#{u(gend_image_page_url(:id => @gend_image.id_hash))}", class: 'btn') do %>
            <i class="icon-google-plus"></i> Google+
        <% end %>

        <% if browser.android? %>
            <%= link_to("sms:?body=#{u(@gend_image_url)}", class: 'btn') do %>
                <i class="icon-mobile-phone"></i> SMS
            <% end %>
        <% end %>

        <%= link_to({ controller: :gend_images, action: :new, src: @src_image.id_hash }, class: 'btn') do %>
            <i class="icon-pencil"></i> New meme using this image
        <% end %>

        <p class="meme-meta">
          <%= link_to @gend_image_url, @gend_image_url %>
        </p>

        <p>Size: <%= @gend_image.width %>x<%= @gend_image.height %></p>

        <p>Created: <%= @gend_image.created_at %></p>

        <a href="#qr-modal" role="button" class="btn" data-toggle="modal">QR code to phone</a>

        <div id="qr-modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="modal-label" aria-hidden="true">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
            <h3 id="modal-label">QR code to phone</h3>
          </div>

          <div class="modal-body">
            <%= image_tag("https://chart.googleapis.com/chart?chs=400x400&cht=qr&chl=#{u(@gend_image_url)}",
                          'data-dismiss' => 'modal') %>
          </div>

          <div class="modal-footer">
            <button class="btn" data-dismiss="modal" aria-hidden="true">Done</button>
          </div>
        </div>
      </div>
    </div>
<% end %>
